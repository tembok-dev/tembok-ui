---
import { variants, cx } from "./utils/variants";

type Intent =
  | "primary"
  | "secondary"
  | "neutral"
  | "ghost"
  | "success"
  | "warning"
  | "info"
  | "danger";
type Size = "sm" | "md" | "lg";
type Tone = "default" | "ink" | "red" | "lime" | "cyan";

const base = "tmbk-theme tmbk-btn tmbk-btn--icon";

const cls = variants(
  base,
  {
    intent: {
      primary: "",
      secondary: "",
      neutral: "",
      ghost: "",
      success: "",
      warning: "",
      info: "",
      danger: "",
    },
    size: {
      sm: "tmbk-btn--sm",
      md: "tmbk-btn--md",
      lg: "tmbk-btn--lg",
    },
    tone: {
      default: "",
      ink: "",
      red: "",
      lime: "",
      cyan: "",
    },
    disabled: {
      true: "",
      false: "",
    },
  },
  { intent: "primary", size: "sm", tone: "default", disabled: "false" }
);

const {
  as = "button",
  label = "Icon button",
  intent = "primary",
  size = "sm",
  tone = "default",
  disabled = false,
  pulse = false,
  class: className,
  ...attrs
} = Astro.props;

const Tag = as;
const classNames = cx(
  cls({ intent, size, tone, disabled: String(disabled) }),
  className
);
const dataAttrs = { "data-intent": intent, "data-tone": tone };
const labelled = { "aria-label": label, title: label };
const isButton = Tag === "button";
---

<Tag
  class={classNames}
  {...dataAttrs}
  {...labelled}
  disabled={isButton ? !!disabled : undefined}
  aria-disabled={!isButton && disabled ? "true" : undefined}
  {...attrs}
>
  {pulse && (
    <span aria-hidden="true" class="tmbk-btn__pulse">
      <span class="tmbk-btn__pulse-dot" />
    </span>
  )}
  <span class="tmbk-icon">
    <slot />
  </span>
</Tag>
